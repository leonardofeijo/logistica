-- Listagem PICK

SELECT DISTINCT TPO001.PO0101 AS ARTIGO
FROM AUTO.D805DATHPO.TPO001 TPO001
INNER JOIN (SELECT DISTINCT LLPPN AS ARTIGOSTK, LLBLT1, LLBLT2, LLBLT3, LLBLT4 FROM AUTO.D805DATHPO.IC130M  WHERE LLSTLC = 'MP-KANB') STOCK
  ON STOCK.ARTIGOSTK = TPO001.PO0101
WHERE TPO001.PO0107 = '03'
  AND TPO001.PO0117 = 'PICK'
  AND (STOCK.LLBLT1 + STOCK.LLBLT2 + STOCK.LLBLT3 + STOCK.LLBLT4 <> 0)
  
-- ETIQUETAS

SELECT DISTINCT TPO001.PO0101 AS ARTIGO, FET001.PLACE, FET001.ETIQUETA, FET001.QTD 
FROM AUTO.D805DATHPO.TPO001 TPO001
INNER JOIN (SELECT DISTINCT LLPPN AS ARTIGOSTK, LLBLT1, LLBLT2, LLBLT3, LLBLT4 FROM AUTO.D805DATHPO.IC130M  WHERE LLSTLC = 'MP-KANB') STOCK
  ON STOCK.ARTIGOSTK = TPO001.PO0101
LEFT JOIN (SELECT ET0102 AS ARTIGO, ET0109 AS PLACE, ET0101 AS ETIQUETA, ET0103 AS QTD FROM AUTO.D805DATHPO.FET001 WHERE ET0105 = 'DIS' AND ET0104 = 'MP-KANB') FET001
  ON FET001.ARTIGO = TPO001.PO0101
WHERE TPO001.PO0107 = '03'
  AND TPO001.PO0117 = 'PICK'
  AND (STOCK.LLBLT1 + STOCK.LLBLT2 + STOCK.LLBLT3 + STOCK.LLBLT4 <> 0)
ORDER BY PLACE, ARTIGO
