-- Por Leonardo Feij√≥ (14/06/2024)
SELECT DISTINCT TPO001.PO0101 AS ARTIGO, STOCK.LLSTLC AS PLACE, STOCK.TOTAL, FET001.ETIQUETA, FET001.QTD, FET001.DATE, FET001.USR FROM AUTO.D805DATHPO.TPO001 TPO001 INNER JOIN ( SELECT DISTINCT LLPPN AS ARTIGOSTK, LLSTLC, (LLBLT1 + LLBLT2 + LLBLT3 + LLBLT4) AS TOTAL FROM AUTO.D805DATHPO.IC130M WHERE LLSTLC LIKE '%UAP%' ) STOCK ON STOCK.ARTIGOSTK = TPO001.PO0101 LEFT JOIN ( SELECT ET0102 AS ARTIGO, ET0104 AS PLACE, ET0101 AS ETIQUETA, ET0103 AS QTD, ET0192 AS DATE, ET0193 AS USR FROM AUTO.D805DATHPO.FET001 WHERE ET0105 = 'DIS' ) FET001 ON FET001.ARTIGO = STOCK.ARTIGOSTK AND FET001.PLACE = STOCK.LLSTLC WHERE TPO001.PO0107 = '03' AND TPO001.PO0117 = 'PICK' AND (STOCK.TOTAL <> 0) ORDER BY PLACE
