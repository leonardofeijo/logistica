-- RECEÇÕES NO DIA ATUAL

SELECT ET0110 AS CODE, ET0111 AS SUPLIER, ET0104 AS PLACE, ET0102 AS COMPONENT, ET0103 AS QTF,
    DATE( SUBSTR(REC.ET0114, 1,4)||'-'||SUBSTR(REC.ET0114, 5,2)||'-'||SUBSTR(REC.ET0114, 7,2) ) AS DLVDT
    FROM AUTO.D805DATHPO.FET001 REC
WHERE ET0114 LIKE '2024062%' AND ET0110 <> ''

--

SELECT DISTINCT REC.CODE, REC.COMPONENT, SUM(REC.QTF) AS QTF
    FROM (
        SELECT ET0110 AS CODE, ET0102 AS COMPONENT, FLOAT(ET0103) AS QTF,
            DATE( SUBSTR(FET.ET0114, 1,4)||'-'||SUBSTR(FET.ET0114, 5,2)||'-'||SUBSTR(FET.ET0114, 7,2) ) AS DLVR
            FROM AUTO.D805DATHPO.FET001 FET
        WHERE ET0114 LIKE '20240625%' AND ET0110 <> ''
    ) REC
GROUP BY COMPONENT, CODE
ORDER BY COMPONENT

--

SELECT DISTINCT REC.CODE, REC.COMPONENT, SUM(REC.QTF) AS QTF, REC.DLVR AS DLVR, 
(SELECT MAX(ET0192) FROM AUTO.D805DATHPO.FET001) AS TODAY
    FROM (
        SELECT ET0110 AS CODE, ET0102 AS COMPONENT, FLOAT(ET0103) AS QTF, INT(FET.ET0114) AS DLVR
            FROM AUTO.D805DATHPO.FET001 FET
        WHERE ET0114 > '20240625' AND ET0110 <> ''
    ) REC
GROUP BY COMPONENT, CODE, DLVR
ORDER BY COMPONENT